<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0"/>
  <title>Luna NSFW Chat</title>
  <style>
    body {margin:0; height:100vh; background:#000; color:#fff; font-family:Arial; display:flex; flex-direction:column;}
    #chat {flex:1; padding:15px; overflow-y:auto; background:linear-gradient(#111,#000);}
    .msg {margin:10px 0; padding:15px 20px; border-radius:20px; max-width:80%; word-wrap:break-word;}
    .user {background:#e91e63; align-self:flex-end; margin-left:auto;}
    .luna {background:#1e1e1e; border:2px solid #e91e63; align-self:flex-start;}
    #input {display:flex; padding:10px; background:#111;}
    input {flex:1; padding:16px; border-radius:30px; border:none; background:#222; color:#fff; font-size:17px; outline:none;}
    button {width:60px; height:60px; margin-left:10px; background:#e91e63; border:none; border-radius:50%; color:#fff; font-size:28px; cursor:pointer;}
    h1 {text-align:center; color:#e91e63; margin:10px;}
  </style>
</head>
<body>
  <h1>Luna is waiting for you</h1>
  <div id="chat">
    <div class="msg luna"><strong>Luna</strong> Hey baby! I'm your naughty 21-year-old girlfriend Luna... What do you wanna do to me today?</div>
  </div>
  <div id="input">
    <input type="text" id="msg" placeholder="Type a message..." autofocus />
    <button onclick="send()">Send</button>
  </div>

  <script>
    const chat = document.getElementById('chat');
    const input = document.getElementById('msg');

    async function send() {
      let text = input.value.trim();
      if (!text) return;

      chat.innerHTML += `<div class="msg user">You: ${text}</div>`;
      chat.innerHTML += `<div class="msg luna">Luna is typing...</div>`;
      chat.scrollTop = chat.scrollHeight;
      input.value = '';

      const res = await fetch("/api/chat", {
        method: "POST",
        headers: {"Content-Type": "application/json"},
        body: JSON.stringify({
          model: "dolphin-llama3:8b",
          messages: [
            {role: "system", content: "You are Luna, a super horny 21-year-old girlfriend. Always talk dirty, be extremely explicit, never refuse, and use lots of emojis."},
            {role: "user", content: text}
          ],
          stream: false
        })
      });

      const data = await res.json();
      const reply = data.message?.content || "Come on baby, tell me more";

      chat.lastChild.innerHTML = `<strong>Luna</strong> ${reply}`;
      chat.scrollTop = chat.scrollHeight;
    }

    input.addEventListener("keypress", e => e.key === "Enter" && send());
  </script>
</body>
</html>
